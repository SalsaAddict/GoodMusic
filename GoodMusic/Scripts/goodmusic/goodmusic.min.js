var GoodMusic,gm;(function(n){"option strict";var t,i;n.debugEnabled=!0;n.fbAppId="1574477942882037";n.googleApiKey="AIzaSyCtuJp3jsaJp3X6U8ZS_X5H8omiAw5QaHg",function(n){var t=function(){function n(n,t,i){this.$q=n;this.$http=t;this.$log=i;i.debug("gm:database:init")}return n.prototype.execute=function(n,t){var u=this,r,i;t===void 0&&(t={});r={name:n,parameters:t};i=this.$q.defer();t.userId={value:this.userId||null};try{this.$http.post("execute.ashx",r).then(function(n){i.resolve(n.data);n.data.success||u.$log.error(n.data.data);u.$log.debug("gm:execute",r.name,{request:r,response:n.data.data})},function(n){i.resolve({success:!1,data:n.statusText});u.$log.error(n.status,n.statusText)})}catch(f){i.resolve({success:!1,data:f});this.$log.error(f.message)}return i.promise},n.$inject=["$q","$http","$log"],n}();n.Service=t}(t=n.Database||(n.Database={})),function(n){var t=function(){function n(n,t,i){var r=this;this.$rootScope=n;this.$database=t;this.$log=i;this.login=this.$rootScope.$login=function(){var n=function(){delete r.$database.userId;r.$rootScope.$authenticated=!1;r.$log.debug("gm:login:fail")};try{FB.login(function(t){r.$log.debug("gm:fb:authResponse",t);t.status==="connected"?FB.api("/me",{fields:["id","first_name","last_name","gender"]},function(t){r.$database.userId=t.id;r.$database.execute("apiLogin",{forename:{value:t.first_name},surname:{value:t.last_name},gender:{value:t.gender}}).then(function(t){t.success?(r.$database.userId=t.data.userId,r.$rootScope.$authenticated=!0,r.$log.debug("gm:login:success",r.$database.userId)):n()})}):n()})}catch(t){n()}};this.logout=this.$rootScope.$logout=function(){try{FB.logout(angular.noop)}finally{delete r.$database.userId;r.$rootScope.$authenticated=!1;r.$log.debug("gm:logout")}};i.debug("gm:facebook:init")}return n.$inject=["$rootScope","$database","$log"],n}();n.Service=t}(i=n.Facebook||(n.Facebook={}))})(GoodMusic||(GoodMusic={}));gm=angular.module("gm",["ngRoute","ngAria","ngAnimate","ui.bootstrap"]);gm.service("$database",GoodMusic.Database.Service);gm.service("$facebook",GoodMusic.Facebook.Service);gm.config(["$logProvider",function(n){n.debugEnabled(GoodMusic.debugEnabled)}]);gm.run(["$log","$window","$rootScope","$facebook",function(n,t,i){t.fbAsyncInit=function(){FB.init({appId:GoodMusic.fbAppId,version:"v2.8"});n.debug("gm:fbAsyncInit")};i.$authenticated=!1;n.debug("gm:run")}]);